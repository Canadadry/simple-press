unit_tests:
  GET:
    - { url: "/admin/articles/#article_0_slug#/edit", status: 200, out: "ok/article_get" }

  POST:
    - { url: "/admin/articles/#article_0_slug#/edit/metadata",   status: 200, in: "ok/article_edit_metadata_update",           out: "ok/article_edit_metadata_update" }
    - { url: "/admin/articles/#article_0_slug#/edit/metadata",   status: 400, in: "bad_request/article_edit_no_title",         out: "bad_request/article_edit_no_title" }
    - { url: "/admin/articles/#article_0_slug#/edit/metadata",   status: 400, in: "bad_request/article_edit_no_author",        out: "bad_request/article_edit_no_author" }
    - { url: "/admin/articles/#article_0_slug#/edit/content",    status: 200, in: "ok/article_edit_content_update",            out: "ok/article_edit_content_update" }
    - { url: "/admin/articles/#article_0_slug#/edit/content",    status: 400, in: "bad_request/article_edit_no_content",       out: "bad_request/article_edit_no_content" }
    # - { url: "/admin/articles/#article_0_slug#/edit/block_edit", status: 200, in: "ok/article_edit_block_edit",                out: "ok/article_edit_block_edit" }
    # - { url: "/admin/articles/#article_0_slug#/edit/block_edit", status: 400, in: "bad_request/article_edit_block_id_missing", out: "bad_request/article_edit_block_id_missing" }
    # - { url: "/admin/articles/#article_0_slug#/edit/block_add",  status: 200, in: "ok/article_edit_block_add",                 out: "ok/article_edit_block_add" }
    # - { url: "/admin/articles/#article_0_slug#/edit/block_add",  status: 400, in: "bad_request/article_edit_block_unknown",    out: "bad_request/article_edit_block_unknown" }

files:
  responses/ok/article_get.json: >
    {
      "title":"index",
      "author":"metoo",
      "slug":"index",
      "content":"@string@.isNotEmpty()",
      "draft":false,
      "layout_id":1,
      "layouts":[
        {"name":"list.html","value":2},
        {"name":"single.html","value":1}
      ],
      "blocks":[{"name":"first_block","value":1}],
      "block_datas":[]
    }

  payloads/ok/article_edit_metadata_update.json: >
    {
      "title": "Updated",
      "author": "Alice",
      "slug": "my-article",
      "draft": false,
      "layout": 1
    }

  responses/ok/article_edit_metadata_update.json: >
    {
      "title":"Updated",
      "author":"Alice",
      "slug":"my-article",
      "content":"@string@.isNotEmpty()",
      "draft":false,
      "layout_id":1,
      "layouts":[
        {"name":"list.html","value":2},
        {"name":"single.html","value":1}
      ],
      "blocks":[{"name":"first_block","value":1}],
      "block_datas":[]
    }

  payloads/bad_request/article_edit_no_title.json: >
    {
      "author": "Alice",
      "slug": "my-article",
      "layout":1
    }

  responses/bad_request/article_edit_no_title.json: >
    {
      "title": ["this value should not be blank"],
      "author": [],
      "slug": [],
      "layout": [],
      "draft": []
    }


  payloads/bad_request/article_edit_no_author.json: >
    {
      "title": "Updated",
      "slug": "my-article",
      "layout":1
    }

  responses/bad_request/article_edit_no_author.json: >
    {
      "title": [],
      "author": ["this value should not be blank"],
      "slug": [],
      "layout": [],
      "draft": []
    }


  payloads/ok/article_edit_content_update.json: >
    {
      "content": "New body content"
    }

  responses/ok/article_edit_content_update.json: >
    {
    "title":"index",
    "author":"metoo",
    "slug":"index",
    "content":"New body content",
    "draft":false,
    "layout_id":1,
    "layouts":[
        {"name":"list.html","value":2},
        {"name":"single.html","value":1}
    ],
    "blocks":[{"name":"first_block","value":1}],
    "block_datas":[]
    }

  payloads/bad_request/article_edit_no_content.json: >
    {}

  responses/bad_request/article_edit_no_content.json: >
    {
      "content": ["this value should not be blank"]
    }

  payloads/ok/article_edit_block_edit.json: >
    {
      "edited_block_id": "#block_data_uuid#",
      "edited_block_position": 0,
      "edited_block_data": { "text": "updated text" }
    }

  responses/ok/article_edit_block_edit.json: >
    {
      "title": "My Article",
      "author": "John",
      "slug": "my-article",
      "content": "Lorem ipsum",
      "draft": false,
      "layout_id": 1,
      "layouts": [{ "name":"default", "value":1 }],
      "blocks": [
        { "name": "text", "value": 10 }
      ],
      "block_datas": [
        {
          "id": "#block_data_uuid#",
          "data": { "text": "updated text" }
        }
      ]
    }

  payloads/bad_request/article_edit_block_id_missing.json: >
    {
      "edited_block_data": {"text":"x"}
    }

  responses/bad_request/article_edit_block_id_missing.json: >
    {
      "edited_block_id": ["this value is required"]
    }

  payloads/ok/article_edit_block_add.json: >
    {
      "added_block_id": 10
    }

  responses/ok/article_edit_block_add.json: >
    {
      "title": "My Article",
      "author": "John",
      "slug": "my-article",
      "content": "Lorem ipsum",
      "draft": false,
      "layout_id": 1,
      "layouts": [{ "name":"default", "value":1 }],
      "blocks": [
        { "name":"text", "value":10 }
      ],
      "block_datas": [
        { "id":"#block_data_uuid#", "data":{ "text":"hello world" } },
        { "id":"#new_block_uuid={{@string@}}", "data":{ "text":"" } }
      ]
    }

  payloads/bad_request/article_edit_block_unknown.json: >
    {
      "added_block_id": 999
    }

  responses/bad_request/article_edit_block_unknown.json: >
    {
      "added_block_id": ["unknown block id"]
    }
