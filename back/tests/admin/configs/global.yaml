unit_tests:
  GET:
    - { url: "/admin/global/definition", status: 200 ,out: "global_definition"}
    - { url: "/admin/global/data",       status: 200 ,out: "global_data"}

  PATCH:
    - { url: "/admin/global/definition", status: 200, in: "global_definition_edit",                out: "global_definition_edit" }
    - { url: "/admin/global/definition", status: 400, in: "global_definition_edit_no_definition",  out: "global_definition_edit_no_definition" }
    - { url: "/admin/global/definition", status: 400, in: "global_definition_edit_bad_definition", out: "global_definition_edit_bad_definition" }
    - { url: "/admin/global/data"      , status: 400, in: "global_data_edit_no_data",              out: "global_data_edit_no_data" }

scenario:
  patch_data:
    - { action: "PATCH", url: "/admin/global/definition", status: 200, in: "global_definition_edit", out: "global_definition_edit" }
    - { action: "PATCH", url: "/admin/global/data"      , status: 200, in: "global_data_edit",       out: "global_data_edit" }
    - { action: "GET"  , url: "/admin/global/data"      , status: 200,                               out: "global_data_edit" }
  patch_definition:
    - { action: "PATCH", url: "/admin/global/definition" , status: 200, in: "global_definition_edit", out: "global_definition_edit" }
    - { action: "GET"  , url: "/admin/global/definition" , status: 200,                               out: "global_definition_edit" }
  page_preview_use_global:
    - { action: "GET"  , url: "/admin/articles/#article_0_slug#/preview", status: 200, ct_out: "text/html" }
    - { action: "POST" , url: "/admin/templates/baseof.html/edit", status: 200, in: "add_data_to_baseof"}
    #- { action: "GET"  , url: "/admin/articles/#article_0_slug#/preview", status: 409}
    - { action: "PATCH", url: "/admin/global/definition" , status: 200, in: "set_global_definition_baseof",  }
    - { action: "GET"  , url: "/admin/articles/#article_0_slug#/preview", status: 200, ct_out: "text/html" ,out: "preview_article_def.html"}
    - { action: "PATCH", url: "/admin/global/data" , status: 200, in: "set_global_data_baseof",  }
    - { action: "GET"  , url: "/admin/articles/#article_0_slug#/preview", status: 200, ct_out: "text/html" ,out: "preview_article_data.html"}
  data_allways_up_to_date:
    - { action: "GET"  , url: "/admin/global/data"      , status: 200,                               out: "data_before_patch_def" }
    - { action: "PATCH", url: "/admin/global/definition", status: 200, in: "global_definition_edit", out: "global_definition_edit" }
    - { action: "GET"  , url: "/admin/global/data"      , status: 200,                               out: "data_after_patch_def" }

files:
  responses/global_definition.json: >
    {
      "definition": {}
    }

  responses/global_data.json: >
    {
      "data": {}
    }

  payloads/global_definition_edit.json: >
    {
      "definition": {
        "SiteTitle": "My website",
        "ItemsPerPage": 10,
        "EnableComments": true
      }
    }

  responses/global_definition_edit.json: >
    {
      "definition": {
        "SiteTitle": "My website",
        "ItemsPerPage": 10,
        "EnableComments": true
      }
    }

  payloads/global_definition_edit_no_definition.json: >
    {
    }

  responses/global_definition_edit_no_definition.json: >
    {
      "definition": ["this value should not be blank"]
    }

  payloads/global_definition_edit_bad_definition.json: >
    {
      "definition": "invalid map"
    }

  responses/global_definition_edit_bad_definition.json: >
    {
      "definition":  ["this value should not be blank"]
    }

  payloads/global_data_edit.json: >
    {
      "data": {
        "ItemsPerPage": 25
      }
    }

  responses/global_data_edit.json: >
    {
      "data": {
        "SiteTitle": "My website",
        "ItemsPerPage": 25,
        "EnableComments": true
      }
    }

  payloads/global_data_edit_no_data.json: >
    {
    }

  responses/global_data_edit_no_data.json: >
    {
      "data": ["this value should not be blank"]
    }

  payloads/add_data_to_baseof.json: >
    {
      "name":"baseof.html",
      "content": "<h1>{{.Global.TitleFromGlobal}}</h1>"
    }

  payloads/set_global_definition_baseof.json: >
    {
      "definition": {
        "TitleFromGlobal": "My website"
      }
    }

  responses/preview_article_def.html: "<h1>My website</h1>"

  payloads/set_global_data_baseof.json: >
    {
      "data": {
        "TitleFromGlobal": "My super website"
      }
    }

  responses/preview_article_data.html: "<h1>My super website</h1>"

  responses/data_before_patch_def.json: >
    {"data":{}}

  responses/data_after_patch_def.json: >
    {"data":{"EnableComments":true,"ItemsPerPage":10,"SiteTitle":"My website"}}
